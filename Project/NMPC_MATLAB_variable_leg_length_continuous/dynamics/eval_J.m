function J = eval_J(q, l1c, l2c)
    [m1, m2, m3, l1, l2, l3, ~] = set_parameters;
    q1 = q(3);
    q2 = q(4);
    q3 = q(5);

    t2 = cos(q1);
    t3 = cos(q2);
    t4 = cos(q3);
    t5 = sin(q1);
    t6 = sin(q2);
    t7 = sin(q3);
    t8 = m1+m2;
    t9 = m3+t8;
    t10 = 1.0./t9;
    t11 = l1.*m1.*t2.*t10;
    t12 = l2.*m2.*t3.*t10;
    t13 = l3.*m3.*t4.*t10;
    t14 = l1.*m1.*t5.*t10;
    t15 = l2.*m2.*t6.*t10;
    t16 = l3.*m3.*t7.*t10;
    t17 = -t13;
    t18 = -t14;
    t19 = -t15;
    J = reshape([1.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,1.0,t11,t18,t11-l1c.*t2,t18+l1c.*t5,t11,t18,t11,t18,t12,t19,t12,t19,t12-l2c.*t3,t19+l2c.*t6,t12,t19,t17,t16,t17,t16,t17,t16,l3.*t4.*t8.*t10,-l3.*t7.*t8.*t10],[8,5]);
    
%     t2 = cos(q1);
%     t3 = cos(q2);
%     t4 = cos(q3);
%     t5 = sin(q1);
%     t6 = sin(q2);
%     t7 = sin(q3);
%     t8 = m1+m2;
%     t9 = m1+m3;
%     t10 = m2+m3;
%     t11 = m3+t8;
%     t12 = 1.0./t11;
%     t13 = l1.*m1.*t2.*t12;
%     t14 = l2.*m2.*t3.*t12;
%     t15 = l3.*m3.*t4.*t12;
%     t16 = l1.*m1.*t5.*t12;
%     t17 = l2.*m2.*t6.*t12;
%     t18 = l3.*m3.*t7.*t12;
%     t19 = -t15;
%     t20 = -t16;
%     t21 = -t17;
%     J = reshape([1.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,1.0,t13,t20,-l1.*t2.*t10.*t12,l1.*t5.*t10.*t12,t13,t20,t13,t20,t14,t21,t14,t21,-l2.*t3.*t9.*t12,l2.*t6.*t9.*t12,t14,t21,t19,t18,t19,t18,t19,t18,l3.*t4.*t8.*t12,-l3.*t7.*t8.*t12],[8,5]);
end